
<nz-table 
*ngIf="productType === 1"
[nzData]="data.data"
[(nzPageIndex)]="dto.page"
[(nzPageSize)]="dto.size"
[nzTotal]="data.totalCount"
(nzPageIndexChange)="getData()"
(nzPageSizeChange)="getData()"
[nzFrontPagination]="false"
nzShowTotal
nzShowQuickJumper
nzShowSizeChanger>
<thead>
    <tr>
        <th>序号</th>
        <th>构件名称</th>
        <th>构件编号</th>
        <th>规格</th>
        <th>长度(mm)</th>
        <th>材质</th>
        <th>数量</th>
        <th>单重(kg)</th>
        <th>总重(kg)</th>
        <th>安装</th>
    </tr>
    
</thead>
<tbody>
    <tr *ngFor="let item of data.data;let i = index">
        <td>{{ i + 1 }}</td>
        <td>{{ item.productInfo.name }}</td>
        <td>{{ item.productInfo.serialNo }}</td>
        <td>{{ item.productInfo.specification }}</td>
        <td>{{ item.productInfo.length }}</td>
        <td>{{ item.productInfo.material }}</td>
        <td>{{ item.productInfo.totalQuantity }}</td>
        <td>{{ item.productInfo.pieceWeight }}</td>
        <td>{{ item.productInfo.totalWeight }}</td>
        
        <td>
            {{item.recordQuantity}}
        </td>
    </tr>
    <tr style="background-color: #fafafa">
        <td>汇总统计</td>
        <td></td>
        <td></td>
        <td>安装数量</td>
        <td>{{summary.totalQuantity}}</td>
        <td>(支)</td>
        <td>安装总量</td>
        <td>{{(summary.totalWeightOrArea / 1000).toFixed(2)}}</td>
        <td>(t)</td>
        <td></td>
    </tr>
</tbody>
</nz-table>

<nz-table 
*ngIf="productType === 2"
[nzData]="data.data"
[(nzPageIndex)]="dto.page"
[(nzPageSize)]="dto.size"
[nzTotal]="data.totalCount"
(nzPageIndexChange)="getData()"
(nzPageSizeChange)="getData()"
[nzFrontPagination]="false"
nzShowTotal
nzShowQuickJumper
nzShowSizeChanger>
<thead>
    <tr>
        <th>序号</th>
        <th>产品名称</th>
        <th>颜色</th>
        <th>厚度(mm)</th>
        <th>板型</th>
        <th>有效宽度(mm)</th>
        <th>长度(m)</th>
        <th>数量(张)</th>
        <th>总长度(m)</th>
        <th>总面积</th>
        <th>安装数量</th>
        <th>安装面积</th>
    </tr>
</thead>
<tbody>
    <tr *ngFor="let item of data.data;let i = index">
        <td>{{ i + 1 }}</td>
        <td>{{ item.productInfo.name }}</td>
        <td>{{ item.productInfo.color }}</td>
        <td>{{ item.productInfo.thickness }}</td>
        <td>{{ item.productInfo.modelNum }}</td>
        <td>{{ item.productInfo.width }}</td>
        <td>{{ item.productInfo.length }}</td>
        <td>{{ item.productInfo.totalQuantity }}</td>
        <td>{{ (item.productInfo.length * item.productInfo.totalQuantity).toFixed(2) }}</td>
        <td>{{ (item.productInfo.length * item.productInfo.width * item.productInfo.totalQuantity * (1/1000)).toFixed(2) }}</td>
       
       
        <td>{{item.recordQuantity}}</td>
        <td>
            {{(item.recordQuantity * item.productInfo.length * item.productInfo.width * (1 / 1000)).toFixed(2)}}
        </td>
    </tr>
    <tr style="background-color: #fafafa">
            <td>汇总统计</td>
            <td></td>
            <td></td>
            <td></td>
            <td>安装数量</td>
            <td>{{summary.totalQuantity}}</td>
            <td>(支)</td>
            <td>安装面积</td>
            <td>{{(summary.totalWeightOrArea / 1000).toFixed(2)}}</td>
            <td>(㎡)</td>
            <td></td>
            <td></td>
        </tr>
</tbody>


</nz-table>

<button nz-button nzType="primary" (click)="export()" style="margin-top: 30px">导出</button>
